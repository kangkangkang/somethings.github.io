---
layout: post
title: "密码学简述：密码的演变(上)"
subtitle: "本篇从凯撒移位密码将起，简要介绍了两种使密码编码者占尽优势的密码：单字母表替换密码和多字母表替换密码。"
header-img: "header-img/NACRYPT-01-header-img.webp"
date: 2016-10-11
author: "Eldath"
tags:
- Tech
- Cryptography
- Series Articles
---

> 在学校写博客... ...我是不是疯了

# 密码学简述：密码的演变(上)

##  实用密码

在开始谈这个问题之前，我们需先定义“实用密码”。我认为，实用密码必须满足以下特征：

1. 它必须属于密码术。（所以隐文术之类的就不能算）；

2. 它至少能提供50年内五十年内不被破解的中等安全性；

3. 它的计算量不超过当时当时的 **平均** 水平；

4. 它使用的技术已普及，不超过当时的 **平均** 水平。（所以量子密码术啥的就不能算）

##  最早的 ***实用***  密码

### 引言

符合上述要求的最早的 **实用** 密码，应该就是凯撒移位密码了。它 **早期** 的使用方法非常简单，请看下面的例子：

> 明文：e l d a t h  i s  t h e  m o s t  l o v e l y  p e r s o n.
>
> 密文：H O G O W K  L V  W K H  P R V W  O R Y H O B  S H U V R Q.

> 依照密码学的惯例，从今往后，明文一律使用小写，密文一律使用大写。

有一些密码学基础的读者，可以在遮住密码的情况下，尝试破译了。

### 工作方式

凯撒移位密码的工作方式相当简单，看看下面的分析：

![凯撒移位密码工作方式分析](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161023_122041.webp)

就是将明文字母表按顺序位移，并将多/少出来的部分补到密文字母表的前/后面去：

![凯撒移位密码工作方式说明](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_195713.webp)

这样，一个凯撒移位密码的字母表就生成了。只要保证通信双方都知道这个密钥，使用它来传递信息，足以保证最最基本的安全性。

## 总结

作为世界上第一个实用密码，凯撒移位密码的安全性实在不高。但由于当时密码破译术还未出现，凯撒移位密码也能在一定范围内保护信息安全了。

##  单字母表替换密码(又称简单替换密码)

### 引言

说明凯撒移位密码以让读者明白那是密码的工作方式之后，接下来让我们看看更高级的密码：

### 工作方式

与凯撒移位密码不同的是，单字母表替换密码不是对字母表进行位移，而是直接 **随机地** 将明文字母与密文字母进行对应：

> 明文：a b c d e f g h i j k l m n o p q r s t u v w x y z
>
> 密文：C D G H K N M Z W A V F E J I L O U R S T V Y P X Q

这就是简单的单字母表替换密码，它的明文字母与密文字母的对应完全是随机的，因而比凯撒移位密码提供了更高的安全性，因为不能像凯撒移位密码一样通过将密文字母放到字母表中来得到位移量。

但这种密码有个缺点，由于明文字母 - 密文字母的对应是随机的，导致传递密钥必须传递整个字母表，使得密钥的分发相对不方便。因此，在此基础上， **关键词单字母表替换密码密码** 诞生了：

> 明文：a b c d e f g h i j k l m n o p q r s t u v w x y z
>
> 密文：R A Y E L D A T H I J K L M N O P Q R S T U V W X Y

对，在这次示例中，我们采用 ``Ray Eldath`` 作为关键词，然后将剩余部分依据关键词末尾最后一个字母，按 **去除在关键词中出现的字母后的字母表** 进行顺序填充，(听不懂看例子)这就很好地解决了密钥分发较困难的问题。

---

关键词单字母表替换密码使用关键词与顺序移位相结合的方式，很好地解决了密钥分发的问题，却又得到了和普通单字母表替换密码差不多的安全性，是密码学的一大进步，影响了今后一大批加密算法的工作方式。

## 总结

单字母表替换密码基本代表了当时密码学的最高水平，通过单字母表替换密码再结合混淆（按一定规律随机插入无意义字符）和代码（比如指定 ``α`` 表示 ``ice1000``）的加密方法，使得单字母表替换密码具有了在当时较高的安全性，从而能够在公元前一个千年里保持优势。

## 多字母表替换密码(又称复式替换密码)

### 引言

几个世纪以来，单字母表替换密码已经足以保证信息的安全。然而，从阿拉伯开始继而到欧洲的频度分析，（将在本系列第四章《密码破译术》降到）使得密码破译者又一次占了上风。

### 工作方式

还是一样，请看下面的例子：

> 明文：ice1000 is eldath's good friend.
>
> 密文：EDA1000 KO ANZEPD'S CQKA BTETJA.

这一次，位移不再明显了，对吧？甚至连同一个明文字母（注意看 ``good`` ）都对应了两种密文字母，这是如何做到的呢？请看下面的解析：

![多字母表替换密码解析](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_210714.webp)

在这种加密方法中，我们将使用 **多个字母表**，（此处是2个）交替使用，（此处约定 ``先使用第一个 - 然后第二个 - 再又第一个 - ...`` 的次序，以达到提高安全性的目的.

> 那么每个字母表就可以使用生成单字母表替换密码的任一一种方法（当然，我觉得关键词单字母表替换密码效果较好）来生成了。

但这种加密方式的安全性仍不够高，因为当字母表选择规则为 ``A - B - A - ...`` 时，对于每个明文字符，每 ``n`` （ ``n`` 为字母表个数，在这个例子中 ``n=2`` ）次，就会重复（即相同明文字母被加密为相同的密文字母）一次，不懂看↓↓下面↓↓：（还是上面那个字母表）

![多字母表替换密码缺陷分析](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_213956.webp)

~~相信读者已经~~ 大家肯定看出来了，明文和密码有着非常非常明显的重复，这就给这种密码留下了漏洞。

而解决这个问题的唯一方法，就是增加字母表的个数。

下面这张表格是由曾任罗马外交官，并深受阿尔伯提、特里瑟米斯和波特影响的维热纳尔确立的，因而以维热纳尔方阵而著称：

![维热纳尔方阵](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_224840.webp)

再看看下面这个使用维热纳尔密码加密的例子：

> 明  文：Happy birthday!
>
> 关键词：``October``
>
> 密  文：VCIDZ FZFVARBC!

在正式介绍维热纳尔密码的工作方式之前，读过完整文章或具有一定基础的读者，可以尝试结合上文给出的维热纳尔方阵，尝试破译下面的密文（密钥即关键词仍为 ``October`` ）了：

>  密文：OOTUJGNCTWWTICRCMVXLFWUXOTCKCDXTTMXWXCFH

> 欢迎大家将解密后的结果贴在评论区，或者直接给我发邮件。

好了，如果读者已经成功破译了上面这个句子，那么我想你可以跳过下面的解释了；如果你没有成功破译，那么我还是非常建议你看一看作为世界上影响力最大的密码之一的维热纳尔密码的工作方式的：

首先，在维热纳尔方阵中找出关键词对应的那几行组成密码表，比如对于关键词``October``，密码表就是：

![维热纳尔密码"October"对应的密码表](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_231328.webp)

有了密码表，我们就可以逐个密码表对明文进行逐字母加密了：（注意下图，同时注意上图的红框）

![维热纳尔密码加密示例](https://oh8y59tfn.qnssl.com/in-post/talk-about-cryptography/sp161021_231843.webp)

看出来了吗？这就是维热纳尔密码的优点。在上图中我特意将末尾的``z``写了很多次，但却没有一次重复。所以维热纳尔密码的一大优点就在于安全性由关键字长度决定，关键词越长，相同字母明文被加密为相同字母密文（即重复）的次数就越少，安全性也就越高。

---

维热纳尔密码富有创造性地使用了多个密码表作为密钥，同时首次使密码的安全性完全可控，极大地影响今后密码学的发展。在这近乎永无止境的智力竞争中，密码编码者又一次领先了。

## 总结

多字母表替换密码大幅提升了安全性，以至于后来的几代密码都受了它的影响，在密码术还没诞生多久的1586年，创造这么一个领先密码破译者两个多世纪的密码，实在是惊人之举。

# 总结

### 概要

本篇通过大量明文-密文对照示例和工作方式示意图，详细介绍了凯撒移位密码、单字母表替换密码和多字母表替换密码的工作方式及安全性，意在简述密码学诞生最初一个世纪内的发展，毫无疑问地，密码编码者又占尽了优势。

### 推荐阅读&参考书目

- ***《密码故事》*** **, [英] 西蒙·辛格, 湖南出版社. **(***The Code Story*** **, Simon Singh, Coville & Walsh Limited) **

### 课后作业

尝试解密下列密码：

**密码一：**

> 密文：JUXSTISMCQSTUCJWTCTCPJTIPNMNTTSTUVSOTAITXSTCSJHIUTSHTSSOAJOTYRTMMTOUTQJSJUTSNPPAXIRIJTRSTTSMUTSOSUTAXJUICJUTPCUITCMSRLTTUATQSTTTJPO
> 密钥：scratch

**密码二：**

> 密文：GZIYVMGPTUUDCHBCWIFRRMKMFEIESCLHKGMKZRPUGQTIRKEWMZMTECUIUCCIDJIYWDMSMEXTULNLVMNJIFFDMKMHMGJXLLHIVYGVAQIKIFIKVVMUUMFWDKVRZOMYMIYWXGXGXKJHXXRRZLMFMBGIANLVGRRV
> 密钥：prejudice

>  结果将结果将在下篇文章：本系列《密码的演变(下)》中揭晓，欢迎将结果留在评论区。

### 下篇预告

在本文的下半部分里，我们将再介绍两种对二战进程产生了重大影响的密码：恩格玛密码和纳瓦霍密码，继续探寻密码的演化趋势：机械化，和简便化。

# 本篇完

修订于2016-11-27.
